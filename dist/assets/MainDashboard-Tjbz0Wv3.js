import{c as l,g as t,a as n,r as D,i as b,w as V,b as f,f as d,m as K,t as y,e as M,k as C,u as F,o as Y,F as j,l as N,R as z,n as J,h as Q}from"./index-CIT4wXxh.js";import{c as X,a as ee,b as te,r as I,F as ne,i as A,d as B,t as Z}from"./index-Bchi9ja8.js";function oe(s,m){return t(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[n("path",{"fill-rule":"evenodd",d:"M16.5 3.75a1.5 1.5 0 0 1 1.5 1.5v13.5a1.5 1.5 0 0 1-1.5 1.5h-6a1.5 1.5 0 0 1-1.5-1.5V15a.75.75 0 0 0-1.5 0v3.75a3 3 0 0 0 3 3h6a3 3 0 0 0 3-3V5.25a3 3 0 0 0-3-3h-6a3 3 0 0 0-3 3V9A.75.75 0 1 0 9 9V5.25a1.5 1.5 0 0 1 1.5-1.5h6ZM5.78 8.47a.75.75 0 0 0-1.06 0l-3 3a.75.75 0 0 0 0 1.06l3 3a.75.75 0 0 0 1.06-1.06l-1.72-1.72H15a.75.75 0 0 0 0-1.5H4.06l1.72-1.72a.75.75 0 0 0 0-1.06Z","clip-rule":"evenodd"})])}function E(s,m){return t(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[n("path",{d:"m11.645 20.91-.007-.003-.022-.012a15.247 15.247 0 0 1-.383-.218 25.18 25.18 0 0 1-4.244-3.17C4.688 15.36 2.25 12.174 2.25 8.25 2.25 5.322 4.714 3 7.688 3A5.5 5.5 0 0 1 12 5.052 5.5 5.5 0 0 1 16.313 3c2.973 0 5.437 2.322 5.437 5.25 0 3.925-2.438 7.111-4.739 9.256a25.175 25.175 0 0 1-4.244 3.17 15.247 15.247 0 0 1-.383.219l-.022.012-.007.004-.003.001a.752.752 0 0 1-.704 0l-.003-.001Z"})])}function se(s,m){return t(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[n("path",{d:"M21.731 2.269a2.625 2.625 0 0 0-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 0 0 0-3.712ZM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 0 0-1.32 2.214l-.8 2.685a.75.75 0 0 0 .933.933l2.685-.8a5.25 5.25 0 0 0 2.214-1.32L19.513 8.2Z"})])}function le(s,m){return t(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[n("path",{"fill-rule":"evenodd",d:"M12 3.75a.75.75 0 0 1 .75.75v6.75h6.75a.75.75 0 0 1 0 1.5h-6.75v6.75a.75.75 0 0 1-1.5 0v-6.75H4.5a.75.75 0 0 1 0-1.5h6.75V4.5a.75.75 0 0 1 .75-.75Z","clip-rule":"evenodd"})])}function G(s,m){return t(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[n("path",{"fill-rule":"evenodd",d:"M16.5 4.478v.227a48.816 48.816 0 0 1 3.878.512.75.75 0 1 1-.256 1.478l-.209-.035-1.005 13.07a3 3 0 0 1-2.991 2.77H8.084a3 3 0 0 1-2.991-2.77L4.087 6.66l-.209.035a.75.75 0 0 1-.256-1.478A48.567 48.567 0 0 1 7.5 4.705v-.227c0-1.564 1.213-2.9 2.816-2.951a52.662 52.662 0 0 1 3.369 0c1.603.051 2.815 1.387 2.815 2.951Zm-6.136-1.452a51.196 51.196 0 0 1 3.273 0C14.39 3.05 15 3.684 15 4.478v.113a49.488 49.488 0 0 0-6 0v-.113c0-.794.609-1.428 1.364-1.452Zm-.355 5.945a.75.75 0 1 0-1.5.058l.347 9a.75.75 0 1 0 1.499-.058l-.346-9Zm5.48.058a.75.75 0 1 0-1.498-.058l-.347 9a.75.75 0 0 0 1.5.058l.345-9Z","clip-rule":"evenodd"})])}function ae(s,m){return t(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[n("path",{"fill-rule":"evenodd",d:"M7.5 6a4.5 4.5 0 1 1 9 0 4.5 4.5 0 0 1-9 0ZM3.751 20.105a8.25 8.25 0 0 1 16.498 0 .75.75 0 0 1-.437.695A18.683 18.683 0 0 1 12 22.5c-2.786 0-5.433-.608-7.812-1.7a.75.75 0 0 1-.437-.695Z","clip-rule":"evenodd"})])}function O(s,m){return t(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[n("path",{"fill-rule":"evenodd",d:"M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z","clip-rule":"evenodd"})])}const re="/assets/empty-BG2WsZ1K.png";function de(s,m){return t(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})])}function T(s,m){return t(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 0 1 .865-.501 48.172 48.172 0 0 0 3.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"})])}function U(s,m){return t(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"})])}function ie(s,m){return t(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})])}const ce={class:"error-message"},me={class:"flex justify-end"},ue=["disabled"],q={__name:"PostComment",props:{loading:{type:Boolean,default:!0}},emits:["addComment"],setup(s,{emit:m}){const w=s,a=m,_=X({Comment:ee().required().max(100)}),k=D(""),u=D(),L=async()=>{await a("addComment",k.value),u.value.resetForm()};return(P,c)=>(t(),b(d(ne),{ref_key:"formRef",ref:u,onSubmit:L,"validation-schema":d(_)},{default:V(({errors:i})=>[f(d(te),{modelValue:k.value,"onUpdate:modelValue":c[0]||(c[0]=g=>k.value=g),name:"Comment"},{default:V(({field:g})=>[n("textarea",K(g,{class:"input h-32",placeholder:"Enter Your Comment"}),null,16)]),_:1},8,["modelValue"]),n("p",ce,y(i==null?void 0:i.Comment),1),n("div",me,[n("button",{type:"submit",class:"sm-button flex justify-center items-center",disabled:w.loading},[c[1]||(c[1]=M(" Add Comment ")),w.loading?(t(),b(d(I),{key:0,class:"w-6 ml-3"})):C("",!0)],8,ue)])]),_:1},8,["validation-schema"]))}},W=s=>new Date(s).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0}),ge={key:0},he={class:"flex justify-between"},ve={class:"flex items-center space-x-3"},fe={class:"font-semibold text-md"},xe={class:"text-xs text-gray-600 font-semibold"},we={key:0,class:"flex"},ye={class:"text-lg my-3"},Ce={class:"font-semibold flex items-center"},ke={key:2},pe={key:4},be={key:0,class:"p-3 flex justify-between items-start border-b border-t border-gray-300 m-5"},H={__name:"CommentBox",props:{comment:{type:Object,default:()=>{}},isNested:{type:Boolean,default:!0},postId:{type:String,default:null}},emits:["getComment","reLoadReplay"],setup(s,{emit:m}){const w=F(),a=s,_=m,k=async()=>{a.comment.isLiked=!a.comment.isLiked;const c={targetId:a.comment._id,type:a.isNested?"comment":"reply"};await A.post(B.likes,c).then(i=>{const g=i.data.data;a.comment.likesCount=g}).catch(i=>{console.log(i)})},u=async c=>{a.comment.isAddingComment=!0;const i={postId:a.postId,commentId:a.comment._id,text:c};await A.post(B.addReply,i).then(g=>{var $;const h=g.data;return a.comment.replies=(h==null?void 0:h.data)??[],a.comment.repliesCount=(($=h==null?void 0:h.data)==null?void 0:$.length)??0,Z.success((h==null?void 0:h.message)??"Comment Post Success!"),!0}).catch(g=>{var h,$;return Z.error((($=(h=g==null?void 0:g.response)==null?void 0:h.data)==null?void 0:$.message)??"Comment Can't Post!"),!1}).finally(()=>{a.comment.isAddingComment=!1})},L=async()=>{a.comment.isDeleting=!0,await A.delete(`${B.deleteComment}${a.comment._id}`).then(c=>{c.data,_("getComment"),Z.success("Comment Deleted Success!")}).catch(c=>{console.log(c)}).finally(()=>{a.comment.isDeleting=!1})},P=async()=>{a.comment.isDeleting=!0,await A.delete(`${B.deleteReply}${a.comment._id}`).then(c=>{const i=c.data.data;_("reLoadReplay",i),Z.success("Comment Deleted Success!")}).catch(c=>{console.log(c)}).finally(()=>{a.comment.isDeleting=!1})};return(c,i)=>{var g,h,$,r,o;return s.comment?(t(),l("div",ge,[n("div",he,[n("div",ve,[f(d(ie),{class:"w-10 rounded rounded-full p-2 bg-gray-200 border border-gray-500"}),n("div",null,[n("h2",fe,y(s.comment.userId.userName),1),n("p",xe,y(d(W)(s.comment.createdAt)),1)])]),((h=(g=d(w))==null?void 0:g.userData)==null?void 0:h.userId)==(($=s.comment.userId)==null?void 0:$._id)?(t(),l("div",we,[(r=s.comment)!=null&&r.isDeleting?(t(),b(d(de),{key:1,class:"text-red-400 w-12 h-10 py-2 px-3 rounded rounded-full"})):(t(),b(d(G),{key:0,onClick:i[0]||(i[0]=e=>s.isNested?L():P()),class:"text-red-500 w-12 h-10 py-2 px-3 hover:bg-white hover:shadow hover:shadow-xl rounded rounded-full cursor-pointer"}))])):C("",!0)]),n("p",ye,y(s.comment.text),1),n("div",Ce,[(o=s.comment)!=null&&o.isLiked?(t(),b(d(E),{key:0,class:"w-6 text-red-600 cursor-pointer mx-2",onClick:i[1]||(i[1]=e=>k())})):(t(),b(d(U),{key:1,class:"w-6 text-red-600 cursor-pointer mx-2",onClick:i[2]||(i[2]=e=>k())})),M(" "+y(s.comment.likesCount)+" Like ",1),s.isNested?(t(),l("span",ke," | ")):C("",!0),s.isNested?(t(),b(d(T),{key:3,class:"w-6 text-green-600 cursor-pointer mx-2",onClick:i[3]||(i[3]=e=>s.comment.isComment=!0)})):C("",!0),s.isNested?(t(),l("span",pe,y(s.comment.repliesCount)+" Reply",1)):C("",!0)]),s.comment.isComment?(t(),l("div",be,[f(q,{class:"ml-5 w-full",onAddComment:u,loading:s.comment.isAddingComment},null,8,["loading"]),f(d(O),{class:"w-10 rounded rounded-full p-2 cursor-pointer bg-gray-300 ml-2 hover:bg-gray-400",onClick:i[4]||(i[4]=e=>s.comment.isComment=!1)})])):C("",!0)])):C("",!0)}}},_e={key:0,class:"w-3/5 mx-auto my-10"},$e={class:"flex justify-between"},Le={class:"flex items-center space-x-5"},Ae={class:"font-semibold text-xl"},Be={class:"text-sm text-gray-600 font-semibold"},Me={key:0,class:"flex"},Ze={class:"text-2xl font-bold mt-5 mb-3"},De={class:"text-gray-800 text-lg"},Pe={class:"font-semibold flex items-center"},Re={key:0},Ie={class:"flex justify-between items-center"},Se={key:0,class:"flex justify-center items-center text-md font-semibold text-gray-500 mb-5"},je={key:1},Ne={key:1,class:"text-center text-xl m-5 font-semibold"},Ve={key:2,class:"flex justify-center items-center text-xl font-semibold m-10 pb-20 text-gray-500"},Fe={__name:"BlogPosts",setup(s){const m=F(),w=D(!1),a=D([]),_=D(0),k=D(),u=D(),L=async()=>{var r;((r=a.value)==null?void 0:r.length)!=k.value&&(_.value++,w.value=!0,await A.get(`${B.postList}?page=${_.value}&limit=5`).then(o=>{const e=o.data.data;k.value=e.totalPosts;const x=e.posts.map(p=>({...p,isComment:!1,isAddingComment:!1}));a.value=[...a.value,...x]}).catch(o=>{console.log(o)}).finally(()=>{w.value=!1}))},P=()=>{u.value.getBoundingClientRect().bottom<window.innerHeight&&!w.value&&L()},c=async r=>{r.isCommentLoading=!0,await A.get(`${B.getComments}${r._id}`).then(o=>{const e=o.data.data;r.comments=e.commentsTree.map(x=>({...x,isAddingComment:!1})),r.commentsCount=e.totalComments}).catch(o=>{console.log(o)}).finally(()=>{r.isCommentLoading=!1})},i=async(r,o)=>{r.isAddingComment=!0;const e={postId:r._id,text:o};await A.post(B.addComment,e).then(x=>{const p=x.data;return c(r),Z.success((p==null?void 0:p.message)??"Comment Post Success!"),!0}).catch(x=>{var p,v;return Z.error(((v=(p=x==null?void 0:x.response)==null?void 0:p.data)==null?void 0:v.message)??"Comment Can't Post!"),!1}).finally(()=>{r.isAddingComment=!1})},g=async r=>{r.isLiked=!r.isLiked;const o={targetId:r._id,type:"post"};await A.post(B.likes,o).then(e=>{const x=e.data.data;r.likesCount=x}).catch(e=>{console.log(e)})},h=async r=>{r.isDeleting=!0,await A.delete(`${B.deletePost}${r._id}`).then(o=>{const e=o.data;Z.success((e==null?void 0:e.message)??"Post Deleted Success!"),a.value=[],_.value=0,k.value=0,L()}).catch(o=>{console.log(o)}).finally(()=>{r.isDeleting=!1})},$=async r=>{J.push(`/edit-blog/${r}`)};return Y(()=>{u.value.addEventListener("scroll",P),L()}),(r,o)=>(t(),l("div",{class:"scrolling-component w-full pb-10 overflow-y-auto",ref_key:"scrollComponent",ref:u,style:{height:"88vh"}},[a.value.length?(t(),l("div",_e,[(t(!0),l(j,null,N(a.value,e=>{var x,p;return t(),l("div",{key:e._id,class:"my-10 shadow shadow-2xl rounded rounded-lg p-5 bg-white"},[n("div",$e,[n("div",Le,[f(d(ae),{class:"w-14 rounded rounded-full p-3 bg-gray-400"}),n("div",null,[n("h2",Ae,y(e.user.userName),1),n("p",Be,y(d(W)(e.createdAt)),1)])]),((p=(x=d(m))==null?void 0:x.userData)==null?void 0:p.userId)==e.userId?(t(),l("div",Me,[e!=null&&e.isDeleting?(t(),b(d(I),{key:1,class:"text-red-400 w-14 h-12 py-2 px-3 rounded rounded-full"})):(t(),b(d(G),{key:0,class:"text-red-600 w-14 h-12 py-2 px-3 hover:bg-gray-200 rounded rounded-full cursor-pointer",onClick:v=>h(e)},null,8,["onClick"])),f(d(se),{class:"text-blue-600 w-14 h-12 py-2 px-3 hover:bg-gray-200 rounded rounded-full cursor-pointer",onClick:v=>$(e._id)},null,8,["onClick"])])):C("",!0)]),n("h3",Ze,y(e.title),1),n("p",De,y(e.description),1),o[4]||(o[4]=n("hr",{class:"my-3"},null,-1)),n("div",Pe,[e.isLiked?(t(),b(d(E),{key:0,class:"w-8 text-red-600 cursor-pointer mx-2",onClick:v=>g(e)},null,8,["onClick"])):(t(),b(d(U),{key:1,class:"w-8 text-red-600 cursor-pointer mx-2",onClick:v=>g(e)},null,8,["onClick"])),M(" "+y(e.likesCount)+" Like | ",1),f(d(T),{class:"w-8 text-green-600 cursor-pointer mx-2",onClick:v=>(e.isComment||c(e),e.isComment=!0)},null,8,["onClick"]),M(" "+y(e.commentsCount)+" Comment ",1)]),e.isComment?(t(),l("div",Re,[o[3]||(o[3]=n("hr",{class:"my-3"},null,-1)),n("div",Ie,[o[0]||(o[0]=n("h2",{class:"font-semibold text-xl"},"Comments",-1)),f(d(O),{class:"w-14 rounded rounded-full p-3 cursor-pointer hover:bg-gray-100",onClick:v=>e.isComment=!1},null,8,["onClick"])]),e.isCommentLoading?(t(),l("div",Se,[f(d(I),{class:"w-6 mx-3"}),o[1]||(o[1]=M(" Loading... "))])):(t(),l("div",je,[(t(!0),l(j,null,N(e.comments,v=>(t(),l("div",{key:v._id,class:"border border-gray-200 shadow shadow-sm rounded rounded-xl p-3 m-5 bg-slate-50"},[f(H,{comment:v,postId:e._id,onGetComment:S=>c(e)},null,8,["comment","postId","onGetComment"]),v.isComment?(t(!0),l(j,{key:0},N(v.replies,S=>(t(),l("div",{key:S._id,class:"border border-gray-200 shadow shadow-sm rounded rounded-xl p-3 m-5 bg-white"},[f(H,{"is-nested":!1,comment:S,postId:e._id,onReLoadReplay:R=>(v.replies=R,v.repliesCount=(R==null?void 0:R.length)??0)},null,8,["comment","postId","onReLoadReplay"])]))),128)):C("",!0)]))),128)),o[2]||(o[2]=n("hr",{class:"my-3"},null,-1))])),f(q,{onAddComment:v=>i(e,v),loading:e.isAddingComment},null,8,["onAddComment","loading"])])):C("",!0)])}),128))])):!a.value.length&&!w.value?(t(),l("div",Ne,[o[6]||(o[6]=n("img",{src:re,alt:"Login",class:"h-96 w-auto mx-auto my-5"},null,-1)),o[7]||(o[7]=n("p",{class:"text-gray-700"},"No Post Avaiable",-1)),f(d(z),{to:"/add-blog",class:"text-blue-700 underline"},{default:V(()=>o[5]||(o[5]=[M("Add New Post")])),_:1})])):C("",!0),w.value?(t(),l("div",Ve,[f(d(I),{class:"w-12 mx-3"}),o[8]||(o[8]=M(" Loading... "))])):C("",!0)],512))}},He={class:"bg w-screen h-screen relative"},Ee={class:"bg-white shadow shadow-2xl flex justify-between items-center",style:{height:"8vh","min-height":"50px"}},Te={__name:"MainDashboard",setup(s){const m=Q(),w=F(),a=()=>{m.push("/add-blog")},_=()=>{w.logOut(),w.removeToken(),Z.success("User Logged Out successfully"),m.push("/login")};return(k,u)=>(t(),l("main",He,[n("nav",Ee,[u[3]||(u[3]=n("h1",{class:"text-5xl mx-10 font-bold text-blue-900"},"Write Blog",-1)),n("div",{class:"flex items-center text-xl font-semibold mx-5 py-3 px-5 rounded rounded-full hover:bg-blue-50 cursor-pointer",onClick:u[0]||(u[0]=L=>_())},[f(d(oe),{class:"w-10"}),u[2]||(u[2]=M(" Logout "))])]),f(Fe),n("button",{class:"button rounded rounded-full w-20 absolute bottom-5 right-5",onClick:u[1]||(u[1]=L=>a())},[f(d(le))])]))}};export{Te as default};
